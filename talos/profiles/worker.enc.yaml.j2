version: v1alpha1
debug: false
persist: true
machine:
  type: worker
  token: ENC[AES256_GCM,data:Jbae0gPU2Nvu6UO+Tu/B6wzb9HAeLc0=,iv:cNo6/67S2Z5zR3nxP2Ta87Uy9gXOs0b5iu66sDcK9bI=,tag:F3URIp6aVHiZaW37++wPWQ==,type:str]
  ca:
    crt: ENC[AES256_GCM,data:SEMzbe5BfRKY0Kmm3URq735bUrEBGsEu6X26j5+9NAlClIATMXk7jrUQwv9tswnoWnHuse7I2qSgttcXKNWBFDRjDEKx4biPv5JrbzChVVwO2PIEp/dTSEZu3YtZpdtFTo5ezlHf1dfoto9viQBRhYDEszM51fUokDy86WQJxM86+1vd+VNeeVbp3GuZGPaeBGT1wLOx7OMaHTQCyush0280i/WMu4p95/6omWflyR1WiqBxwNsS2GpoKdF3ER37HegLnqQtSVqplMbvH2/CrERB8IESOYVcMbys7x/r2wZoySyPpv/Bi0EpIiUApu6UBQmR+14zazlIjdQdbSTnMpR03NTroS4mkUgijrxD94uNs0FHzGIXJa56xTii/LwrdMPReRaQHyMMTdc0bM9H4bfQ6IaLJ4ZYGKOrYxZ+ax4YuAS0E6faXyW3uQAPBGWs7z950DYH7tPR75ZYbAi31D9vlRvDsrdOto5lhB2P4/5oPjoq3ZavccLG7TeMHwxcVC2/dkIJtBtyUjNc6qLc1JLwCS1GE/cUZWVv2jiGnjMqnpB8Rm9LDF7mKGCFp7GLw5e8GKmyyqGttfN+iTRmPvjHzDMCMVO6SAAsPTxGzczYp8Q/aJE5++a1/7zMRQmus4IeB6HziJNcKH/V1JvllHpTpGHxBlkbO6iiv9E/7p18Bu/1e8tkRbAB74mt3X32WS1J8AtKIJl/Ix/cz848/RhLtZGBbcZ/hX6B41C59Mom01W/NFRZWLrVaL4B8YDqtstsojhSrlcXSHfEBrAqx2c0wSYHBJrWYemzmknCJNRvA5dM9N45lZgphnl2XfPTkJtJdURtWLN4/UX4TL/ur1oH2CsiGrfYdJ+k1sIQbEF47jAA,iv:i3UDTaTKBqJ+zHJgFdvpdHssT2Lgpfra4mmxdgwm304=,tag:MW1n3sO2l4lBPnIInY9OiA==,type:str]
    key: ""
  certSANs:
    - 127.0.0.1
    - 192.168.45.40
  kubelet:
    image: ghcr.io/siderolabs/kubelet:{{ ENV.KUBERNETES_VERSION }}
    extraArgs:
      cloud-provider: external
      rotate-server-certificates: "true"
    extraConfig:
      imageGCHighThresholdPercent: 70
      imageGCLowThresholdPercent: 50
      shutdownGracePeriod: 60s
    extraMounts:
      - destination: /var/openebs/local
        type: bind
        source: /var/openebs/local
        options:
          - bind
          - rshared
          - rw
    defaultRuntimeSeccompProfileEnabled: true
    nodeIP:
      validSubnets:
        - 192.168.45.0/24
    disableManifestsDirectory: true
  network:
    interfaces:
      - deviceSelector:
          # Ensure PCI devices on nodes are selected
          busPath: 0000:*
        mtu: 9000
        dhcp: true
    disableSearchDomain: true
  install:
    diskSelector:
      type: ssd
      size: <= 128GB
    extraKernelArgs:
      - apparmor=0
      - mitigations=off
      - security=none
    image: factory.talos.dev/installer/{{ ENV.TALOS_SCHEMATIC_ID }}:{{ ENV.TALOS_VERSION }}
    wipe: true
  files:
    - path: /etc/cri/conf.d/20-customization.part
      op: create
      content: |
        [plugins."io.containerd.cri.v1.images"]
          discard_unpacked_layers = false
    - path: /etc/nfsmount.conf
      op: overwrite
      permissions: 420
      content: |-
        [ NFSMount_Global_Options ]
        nfsvers=4.2
        hard=True
        nconnect=16
        noatime=True
  sysctls:
    # Watchdog
    fs.inotify.max_user_watches: 1048576
    fs.inotify.max_user_instances: 8192
    # Cloudflared / QUIC
    net.core.rmem_max: 67108864
    net.core.wmem_max: 67108864
    # PostgreSQL
    vm.nr_hugepages: 1024
  registries: {}
  features:
    rbac: true
    stableHostname: true
    apidCheckExtKeyUsage: true
    kubePrism:
      enabled: true
      port: 7445
    hostDNS:
      enabled: true
      resolveMemberNames: true
      forwardKubeDNSToHost: false
cluster:
  id: ENC[AES256_GCM,data:MVm3r/Pt9GNAN3kAxAGfaA8C1oTqClgk5uHQb+GvHr2UmNSELkUNJSc0Eug=,iv:8oOUzqtyb5Rj9l328zNHgf0HLZ9YavjO90wxnYUwclI=,tag:vuw7hSIFN2Z6gw306HphWQ==,type:str]
  secret: ENC[AES256_GCM,data:mUd919diGWiSeUPjBVO88skytJS3l4Osfq5jb4Cg+ko6KO39baK5AqvGbXw=,iv:vSIjNv/27tiRKcK8VnMoFyQEfs52GbQv9BFkEcMI0+8=,tag:6BQP0Ky9s8X+gSxDAFwVcw==,type:str]
  controlPlane:
    endpoint: https://192.168.45.40:6443
  clusterName: home-cluster
  network:
    cni:
      name: none
    dnsDomain: cluster.local
    podSubnets:
      - 10.45.0.0/16
    serviceSubnets:
      - 10.46.0.0/16
  token: ENC[AES256_GCM,data:uJhnyUavwlt7aq+nfgaJ1walbzXzlV8=,iv:GJ9Dtmbm8Zz10BoPzaaxdVQCMGGex68uhQfEEpicgIo=,tag:J51suLCuAQ08Jwpj1HGwDw==,type:str]
  ca:
    crt: ENC[AES256_GCM,data:bh4Hd3NXENvogJ2FFlr6BVS+7LLvDPVcXN3N6AuHRdXUQmR6qSNEF+kTf23nJEgnoWII9yQv5Uvubseg9SGf+91yFAiZpmszvDm5FWeLXkNcNfUbYfX9hTrT+FStkit860XZllmY+K4VtsPnePSInhJDY9K/zNUFUygaQR0f9RfFd6aiOaYSnbAgUSnGoQ13HJdJjye9teswVwEBkjvTSSbJz8L+ZVGpl3TF2lB+JgFfreGURUUXWDNYSf71nPAUoaMbCHX7vi7yR9Tj+yw55coUdsDv8EXYZp9UJiw5X7zbwiR2Y1qoJnIi2jbdVxDRVOco4XK+4+dFmHC77bpfVnN7PmsqZ2jkGlFIrnjBwSt3v+6IQuGWPfQI7G4RBfu/GeRcfVbNfiPuaexwFnn1xeDnLuiFs59HzkYHMf7OT13o9DBOmNvOmXCb6BbMJXMKY1ifF3W3PNE0AcN0jjzYmHi7OvmZI5WsdquywZfO0/RV66jq0uVOC6clQ7njUzkO0XK8pbkRIq1W+1gB6m4suuWEJ3FojCc7mfiIY7fFNpIQVvGEkL7a6utE2NmKy36WgnN6qpHB9FACc2Sl39LctVCeD25mY1P/o6voy8zqg6in2w2FOTlsMDCcekC0pNaclZ9nZxkCAyFriMWWJB1hFew+lc9eIDvX79IjOdV+9Il2Pjnwq4qQ2RUOrpUlGF9+IiLcCg+bCAElfYn1ww0I8Um+qMigELxa5iAeQFdMN9Z8hwK02WFcE7ij2eEDacjoPOBmj7qGu1Df/mwonnwOM79UbFucpKGfoUYhtj/A6I0c/JqsnN2Wh7ERAnJtlTEInnFPd09mjCADZcrCbG7H+FJteYlwCFpoS3RSdczBrRZLJXxORr8QY9EYXQpy0sxGWsBIy0JkgEkMKAyLiREPmjqNPgRc/Cis+D6injuQM8wJT0gqn2WOJh/HOsiopyM13PIZLNdn8eT3QOO5i6eQ0sKvHb1o7Z3pMIMxfmWvhX513AeOfd42MgyBvKZJK0h7usDUjq+vI/s0BaimIK+RWC5i8o2xD1BOu53IGQ==,iv:nHkKiPu4FPVSeq5uYnjIDf6vl/k5m25MZeLguRWcjfI=,tag:2LNmD/g7ZzryBbiGO3GuKg==,type:str]
    key: ""
  proxy:
    disabled: true
  discovery:
    enabled: true
    registries:
      kubernetes:
        disabled: true
      service:
        disabled: false
sops:
  kms: []
  gcp_kms: []
  azure_kv: []
  hc_vault: []
  age:
    - recipient: age13g8vu0uypup5ulq059xrs0gh4nkecvhhpkqmjdp3gpuc4w8q9c4sjys65q
      enc: |
        -----BEGIN AGE ENCRYPTED FILE-----
        YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBUcFBEamVPd1VyV2ZKNWNG
        YVl3S1hqMnloSHRpZFZyVW9OM0J5bGdQZTFFClJpR25nQ252NHV4TlJ6QkVzanpM
        ZHZkZ2R6M0w2OGs5ZiswOVNJVUpLRXcKLS0tIFUwQ3JYbkl3V3UwaFVQd1BPeFU3
        cXFGZytsdzdDNUZCeUZyR1FBVnFJVmcKRg6gHsJY5DcyTEqgVaZoISk2y9g1GWV4
        W2DlYTkjMsFvwuYC/pNIevApDZxm5OfTh6sok+iTIND2QIc+62UgjQ==
        -----END AGE ENCRYPTED FILE-----
  lastmodified: "2025-01-06T03:33:06Z"
  mac: ENC[AES256_GCM,data:oXoQEjuuSRwmJRF1i7jLHsUhTqeAtI5EofU4ihSWiMuiH2p0e/IB+dXZWW/1vkRQLDu8qlkrROeokTOzI7J20NI1rfGVH+IT98LKY7weR8OGwflJ9Xv6D0ifz8+mg5FhfNVueI/sjPBlP52dj1wpYsKbWAlSd3wBLb0cYyOvUyo=,iv:WWG2cH5AKa7Gk9TuXSs5NUZoIn4Yvd0+Avwg+1FQTQQ=,tag:ov9EQMTlLqsJAkqHgQcHOw==,type:str]
  pgp: []
  encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
  mac_only_encrypted: true
  version: 3.9.3
